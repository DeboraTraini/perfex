workflows:
  ios-release-build:
    name: iOS Release Build
    environment:
      groups:
        - ios_signing_group
      vars:
        BUNDLE_ID: "com.perfex.admin"
        CERTIFICATE_PASSWORD: "debbere"
      ios_signing:
        certificates:
          - certificate: $P12_BASE64
            password: $CERTIFICATE_PASSWORD
            type: distribution
        provisioning_profiles:
          - provisioning_profile: $MOBILEPROVISION_BASE64
            type: ad_hoc
    scripts:
      - name: Install dependencies
        script: |
          flutter pub get
      - name: Build iOS
        script: |
          flutter build ios --release
    artifacts:
      - build/ios/ipa/*.ipa
